# SmartRenamer - æ™ºèƒ½åª’ä½“æ–‡ä»¶é‡å‘½åå·¥å…·

SmartRenamer æ˜¯ä¸€ä¸ªåŸºäº TMDB API çš„æ™ºèƒ½åª’ä½“æ–‡ä»¶é‡å‘½åå·¥å…·ï¼Œæ”¯æŒç”µå½±å’Œç”µè§†å‰§æ–‡ä»¶çš„è‡ªåŠ¨è¯†åˆ«å’Œè§„èŒƒåŒ–å‘½åã€‚

## é¡¹ç›®æ¦‚è¿°

SmartRenamer å¯ä»¥å¸®åŠ©æ‚¨ï¼š

- ğŸ¬ è‡ªåŠ¨è¯†åˆ«ç”µå½±å’Œç”µè§†å‰§æ–‡ä»¶
- ğŸ” é€šè¿‡ TMDB API è·å–å‡†ç¡®çš„åª’ä½“ä¿¡æ¯
- âœ¨ æ ¹æ®å¯è‡ªå®šä¹‰çš„è§„åˆ™é‡å‘½åæ–‡ä»¶
- ğŸ–¥ï¸ æä¾›å‹å¥½çš„å›¾å½¢ç•Œé¢ï¼ˆå¼€å‘ä¸­ï¼‰
- ğŸ“Š æ‰¹é‡å¤„ç†å¤§é‡åª’ä½“æ–‡ä»¶

## åŠŸèƒ½ç‰¹æ€§

### å½“å‰ç‰ˆæœ¬ (v0.7.0)

- âœ… å®Œæ•´çš„é¡¹ç›®æ¶æ„
- âœ… æ ¸å¿ƒæ•°æ®æ¨¡å‹ï¼ˆMediaFile, RenameRuleï¼‰
- âœ… é…ç½®ç®¡ç†ç³»ç»Ÿ
- âœ… æ–‡ä»¶ä¿¡æ¯æå–å·¥å…·
- âœ… TMDB API å®¢æˆ·ç«¯å°è£…
- âœ… å•å…ƒæµ‹è¯•æ¡†æ¶ï¼ˆ125ä¸ªæµ‹è¯•ï¼Œ80%è¦†ç›–ç‡ï¼‰
- âœ… **åª’ä½“åº“æ‰«ææ¨¡å—** (v0.2.0)
  - ğŸ” é€’å½’ç›®å½•æ‰«æ
  - ğŸ¬ è‡ªåŠ¨è¯†åˆ«ç”µå½±å’Œç”µè§†å‰§
  - ğŸ’¾ ç¼“å­˜æœºåˆ¶
  - ğŸ”„ å¢é‡æ›´æ–°
  - ğŸ” å¿«é€Ÿæœç´¢æŸ¥è¯¢
- âœ… **æ–‡ä»¶åæ™ºèƒ½è§£æ** (v0.3.0)
  - ğŸ“ è¯†åˆ«å¸¸è§å‘½åæ ¼å¼
  - ğŸ¯ æå–æ ‡é¢˜ã€å¹´ä»½ã€åˆ†è¾¨ç‡ç­‰ä¿¡æ¯
  - ğŸ“º æ”¯æŒç”µè§†å‰§å­£é›†è¯†åˆ«
  - ğŸŒ ä¸­è‹±åŒè¯­æ¥å£
- âœ… **å¢å¼º TMDB å®¢æˆ·ç«¯** (v0.3.0)
  - ğŸ’¾ æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ
  - ğŸ”„ API é‡è¯•æœºåˆ¶
  - ğŸ“… å¹´ä»½è¿‡æ»¤æ”¯æŒ
  - ğŸ“Š å‰§é›†è¯¦æƒ…è·å–
- âœ… **æ™ºèƒ½åŒ¹é…å¼•æ“** (v0.3.0)
  - ğŸ¯ å¤šæ¡ä»¶åŒ¹é…ç®—æ³•
  - ğŸ“ˆ ç›¸ä¼¼åº¦è®¡ç®—
  - ğŸ¤– è‡ªåŠ¨ç¡®è®¤é«˜ç›¸ä¼¼åº¦åŒ¹é…
  - ğŸ“‹ å¤šç»“æœæ”¯æŒ
- âœ… **Jinja2 é«˜çº§é‡å‘½åå¼•æ“** (v0.4.0)
  - ğŸ¨ çµæ´»çš„æ¨¡æ¿ç³»ç»Ÿ
  - ğŸ› ï¸ 7ä¸ªè‡ªå®šä¹‰è¿‡æ»¤å™¨
  - ğŸ“‹ 7ä¸ªé¢„å®šä¹‰æ¨¡æ¿
  - ğŸ‘ï¸ é¢„è§ˆæ¨¡å¼
  - ğŸ“¦ æ‰¹é‡é‡å‘½å
  - â†©ï¸ æ’¤é”€æœºåˆ¶
  - ğŸ”„ æ–‡ä»¶å†²çªå¤„ç†
  - ğŸ“ è§„åˆ™ç®¡ç†å’ŒæŒä¹…åŒ–
- âœ… **æ‰«æä¸å†…å­˜ä¼˜åŒ–** (v0.7.0 æ–°å¢)
  - âš¡ å¹¶è¡Œæ‰«æå¼•æ“ï¼ˆå¤šçº¿ç¨‹ï¼‰
  - ğŸŒŠ æµå¼æ‰¹é‡å¤„ç†
  - ğŸ’¾ å¢é‡ç¼“å­˜ç³»ç»Ÿ
  - ğŸ“Š å®æ—¶è¿›åº¦æ˜¾ç¤º
  - ğŸš€ æ€§èƒ½æå‡ 30%+
  - ğŸ’¨ å†…å­˜ä¼˜åŒ– 25%+

### è®¡åˆ’åŠŸèƒ½

- ğŸ”„ å¤šè¯­è¨€æ”¯æŒ

## æŠ€æœ¯æ ˆ

- **Python**: 3.8+
- **GUI æ¡†æ¶**: PySide6
- **API å®¢æˆ·ç«¯**: tmdbv3api
- **æ¨¡æ¿å¼•æ“**: Jinja2
- **å›¾åƒå¤„ç†**: Pillow
- **æµ‹è¯•æ¡†æ¶**: pytest

## å®‰è£…è¯´æ˜

SmartRenamer æä¾›å¤šç§å®‰è£…æ–¹å¼ï¼Œé€‰æ‹©æœ€é€‚åˆæ‚¨çš„æ–¹å¼ï¼š

### æ–¹å¼ 1: ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆæ¨èï¼‰â­

æœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥ä¸‹è½½å¯¹åº”å¹³å°çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ— éœ€å®‰è£… Python ç¯å¢ƒã€‚

#### Windows

ä» [GitHub Releases](https://github.com/smartrenamer/smartrenamer/releases) ä¸‹è½½ï¼š
- `SmartRenamer-Windows-Setup.exe` - å®‰è£…ç¨‹åºï¼ˆæ¨èï¼‰
- `SmartRenamer-Windows-Portable.zip` - ä¾¿æºç‰ˆ

**å®‰è£…ç¨‹åºä½¿ç”¨**:
1. åŒå‡»è¿è¡Œ `SmartRenamer-Windows-Setup.exe`
2. æŒ‰ç…§å‘å¯¼å®Œæˆå®‰è£…
3. ä»å¼€å§‹èœå•æˆ–æ¡Œé¢å¿«æ·æ–¹å¼å¯åŠ¨

**ä¾¿æºç‰ˆä½¿ç”¨**:
1. è§£å‹ ZIP æ–‡ä»¶
2. åŒå‡» `SmartRenamer.exe` è¿è¡Œ

#### macOS

ä» [GitHub Releases](https://github.com/smartrenamer/smartrenamer/releases) ä¸‹è½½ï¼š
- `SmartRenamer-macOS.dmg` - DMG é•œåƒï¼ˆæ”¯æŒ Intel å’Œ Apple Siliconï¼‰

**ä½¿ç”¨æ–¹æ³•**:
1. ä¸‹è½½å¹¶æ‰“å¼€ `.dmg` æ–‡ä»¶
2. å°† SmartRenamer æ‹–åˆ° Applications æ–‡ä»¶å¤¹
3. é¦–æ¬¡è¿è¡Œå¯èƒ½éœ€è¦åœ¨"ç³»ç»Ÿåå¥½è®¾ç½® > å®‰å…¨æ€§ä¸éšç§"ä¸­å…è®¸

#### Linux

ä» [GitHub Releases](https://github.com/smartrenamer/smartrenamer/releases) ä¸‹è½½ï¼š
- `SmartRenamer-Linux-x86_64.AppImage` - AppImage ä¾¿æºç‰ˆ

**ä½¿ç”¨æ–¹æ³•**:
```bash
# 1. ä¸‹è½½ AppImage
wget https://github.com/smartrenamer/smartrenamer/releases/latest/download/SmartRenamer-Linux-x86_64.AppImage

# 2. æ·»åŠ æ‰§è¡Œæƒé™
chmod +x SmartRenamer-Linux-x86_64.AppImage

# 3. è¿è¡Œ
./SmartRenamer-Linux-x86_64.AppImage
```

### æ–¹å¼ 2: Dockerï¼ˆè·¨å¹³å°ï¼‰ğŸ³

ä½¿ç”¨ Docker æ˜¯æœ€ç®€å•çš„è·¨å¹³å°æ–¹å¼ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ç¯å¢ƒï¼š

```bash
# å¿«é€Ÿå¯åŠ¨ï¼ˆè‡ªåŠ¨é…ç½®ï¼‰
./docker-quickstart.sh

# æˆ–ä½¿ç”¨ Docker Compose
docker-compose up

# æˆ–ä½¿ç”¨ Make
make gui
```

è¯¦ç»†è¯´æ˜è¯·å‚è€ƒ [Docker ä½¿ç”¨æŒ‡å—](DOCKER_USAGE.md)

### æ–¹å¼ 3: Python æºç å®‰è£…ï¼ˆå¼€å‘è€…ï¼‰

é€‚åˆå¼€å‘è€…æˆ–éœ€è¦è‡ªå®šä¹‰çš„é«˜çº§ç”¨æˆ·ã€‚

#### ç¯å¢ƒè¦æ±‚

- Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- pip åŒ…ç®¡ç†å™¨

#### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**

```bash
git clone https://github.com/smartrenamer/smartrenamer.git
cd smartrenamer
```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰**

```bash
python -m venv venv

# Windows
venv\Scripts\activate

# Linux/macOS
source venv/bin/activate
```

3. **å®‰è£…ä¾èµ–**

```bash
pip install -r requirements.txt
```

4. **å¼€å‘æ¨¡å¼å®‰è£…**

```bash
pip install -e .
```

## å¿«é€Ÿå¼€å§‹

### 1. é…ç½® TMDB API

SmartRenamer éœ€è¦ TMDB API Key æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚

1. è®¿é—® [TMDB å®˜ç½‘](https://www.themoviedb.org/) æ³¨å†Œè´¦å·
2. åœ¨è´¦å·è®¾ç½®ä¸­ç”³è¯· API Key
3. åˆ›å»ºé…ç½®æ–‡ä»¶ `~/.smartrenamer/config.json`ï¼š

```json
{
  "tmdb_api_key": "your_api_key_here",
  "tmdb_language": "zh-CN"
}
```

### 2. è¿è¡Œåº”ç”¨

```bash
python src/smartrenamer/main.py
```

æˆ–è€…å¦‚æœå·²å®‰è£…ï¼š

```bash
smartrenamer
```

### 3. ä½¿ç”¨ç¤ºä¾‹

#### æ–‡ä»¶åè§£æç¤ºä¾‹

```python
from smartrenamer.core import FileNameParser

# åˆ›å»ºè§£æå™¨
parser = FileNameParser()

# è§£æç”µå½±æ–‡ä»¶å
result = parser.parse("The.Matrix.1999.1080p.BluRay.x264.mkv")
print(f"æ ‡é¢˜: {result['title']}")      # The Matrix
print(f"å¹´ä»½: {result['year']}")       # 1999
print(f"åˆ†è¾¨ç‡: {result['resolution']}")  # 1080P

# è§£æç”µè§†å‰§æ–‡ä»¶å
result = parser.parse("Breaking.Bad.S01E01.1080p.mkv")
print(f"æ ‡é¢˜: {result['title']}")      # Breaking Bad
print(f"å­£é›†: S{result['season']:02d}E{result['episode']:02d}")  # S01E01
```

#### TMDB åŒ¹é…ç¤ºä¾‹

```python
from smartrenamer.core import Matcher
from smartrenamer.api import EnhancedTMDBClient

# åˆ›å»ºå®¢æˆ·ç«¯å’ŒåŒ¹é…å™¨
client = EnhancedTMDBClient("your_api_key", å¯ç”¨ç¼“å­˜=True)
matcher = Matcher(client)

# åŒ¹é…æ–‡ä»¶
matches = matcher.match_file("The.Matrix.1999.1080p.mkv", max_results=3)

# æŸ¥çœ‹åŒ¹é…ç»“æœ
for i, match in enumerate(matches, 1):
    print(f"{i}. {match.tmdbæ•°æ®['title']}")
    print(f"   ç›¸ä¼¼åº¦: {match.ç›¸ä¼¼åº¦:.2%}")
```

#### å®Œæ•´å·¥ä½œæµç¤ºä¾‹

```python
from smartrenamer.core import FileNameParser, Matcher, MediaFile
from smartrenamer.api import EnhancedTMDBClient
from pathlib import Path

# åˆå§‹åŒ–ç»„ä»¶
parser = FileNameParser()
client = EnhancedTMDBClient("your_api_key")
matcher = Matcher(client, parser)

# åˆ›å»ºåª’ä½“æ–‡ä»¶
file_path = Path("/media/movies/Inception.2010.1080p.mkv")
media_file = MediaFile(
    path=file_path,
    original_name=file_path.name,
    extension=file_path.suffix
)

# åŒ¹é… TMDB æ•°æ®
matches = matcher.match_media_file(media_file, max_results=1)

if matches:
    # åº”ç”¨æœ€ä½³åŒ¹é…
    best_match = matches[0]
    updated_file = matcher.apply_match_to_media_file(media_file, best_match)
    
    print(f"æ ‡é¢˜: {updated_file.title}")
    print(f"å¹´ä»½: {updated_file.year}")
    print(f"TMDB ID: {updated_file.tmdb_id}")
```

#### åŸºæœ¬é‡å‘½åç¤ºä¾‹

```python
from smartrenamer import MediaFile, MediaType, Config

# åˆ›å»ºé…ç½®
config = Config(tmdb_api_key="your_api_key")

# åˆ›å»ºåª’ä½“æ–‡ä»¶å¯¹è±¡
media_file = MediaFile(
    path="/path/to/movie.mkv",
    original_name="movie.mkv",
    extension=".mkv",
    media_type=MediaType.MOVIE,
    title="é»‘å®¢å¸å›½",
    year=1999,
    resolution="1080p",
)

# åº”ç”¨é‡å‘½åè§„åˆ™
from smartrenamer.core import DEFAULT_MOVIE_RULE
new_name = DEFAULT_MOVIE_RULE.apply(media_file)
print(f"æ–°æ–‡ä»¶å: {new_name}")
```

#### åª’ä½“åº“æ‰«æç¤ºä¾‹

```python
from pathlib import Path
from smartrenamer import FileScanner, MediaLibrary

# åˆ›å»ºåª’ä½“åº“å¹¶æ·»åŠ æ‰«ææº
library = MediaLibrary(enable_cache=True)
library.add_scan_source(Path("/path/to/movies"))
library.add_scan_source(Path("/path/to/tv_shows"))

# æ‰«æåª’ä½“åº“
scanner = FileScanner()
total = library.scan(scanner)
print(f"æ‰¾åˆ° {total} ä¸ªåª’ä½“æ–‡ä»¶")

# æŸ¥è¯¢ç”µå½±
movies = library.get_movies()
for movie in movies:
    print(f"{movie.title} ({movie.year})")

# æœç´¢
results = library.search_by_title("Matrix")
```

æ›´å¤šç¤ºä¾‹è¯·æŸ¥çœ‹ [MEDIA_LIBRARY_GUIDE.md](MEDIA_LIBRARY_GUIDE.md) å’Œ `examples/` ç›®å½•ã€‚

## é¡¹ç›®ç»“æ„

```
smartrenamer/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ smartrenamer/
â”‚       â”œâ”€â”€ __init__.py          # ä¸»åŒ…åˆå§‹åŒ–
â”‚       â”œâ”€â”€ main.py              # ç¨‹åºå…¥å£
â”‚       â”œâ”€â”€ core/                # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ models.py        # æ•°æ®æ¨¡å‹
â”‚       â”‚   â””â”€â”€ config.py        # é…ç½®ç®¡ç†
â”‚       â”œâ”€â”€ api/                 # API é›†æˆ
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â””â”€â”€ tmdb_client.py   # TMDB å®¢æˆ·ç«¯
â”‚       â”œâ”€â”€ ui/                  # ç”¨æˆ·ç•Œé¢
â”‚       â”‚   â””â”€â”€ __init__.py
â”‚       â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚           â”œâ”€â”€ __init__.py
â”‚           â””â”€â”€ file_utils.py    # æ–‡ä»¶å·¥å…·
â”œâ”€â”€ tests/                       # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_models.py
â”‚   â”œâ”€â”€ test_config.py
â”‚   â””â”€â”€ test_file_utils.py
â”œâ”€â”€ requirements.txt             # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ pyproject.toml              # é¡¹ç›®é…ç½®
â”œâ”€â”€ setup.py                    # å®‰è£…è„šæœ¬
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥è§„åˆ™
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
```

## å¼€å‘æŒ‡å—

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•æ–‡ä»¶
pytest tests/test_models.py

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=smartrenamer --cov-report=html
```

### ä»£ç é£æ ¼

é¡¹ç›®éµå¾ª PEP 8 ä»£ç è§„èŒƒï¼Œæ‰€æœ‰æ³¨é‡Šå’Œæ–‡æ¡£ä½¿ç”¨ç®€ä½“ä¸­æ–‡ã€‚

### æ‰“åŒ…å’Œæ„å»º

å¦‚æœéœ€è¦æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¯·å‚è€ƒ [PACKAGING_GUIDE.md](PACKAGING_GUIDE.md)ã€‚

**å¿«é€Ÿæ„å»º**:
```bash
# å®‰è£…æ‰“åŒ…ä¾èµ–
pip install pyinstaller

# æ‰§è¡Œæ„å»º
pyinstaller --clean --noconfirm smartrenamer.spec

# macOS å¹³å°æµ‹è¯•
./test_macos_build.sh  # ä»…é™ macOS
```

**æ³¨æ„äº‹é¡¹**:
- macOS ä¸Šå·²ä¿®å¤ PyInstaller çš„ Qt æ¡†æ¶ç¬¦å·é“¾æ¥é—®é¢˜
- è¯¦è§ `docs/MACOS_PYINSTALLER_FIX.md`

### è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'æ·»åŠ æŸä¸ªç‰¹æ€§'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤ Pull Request

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•è·å– TMDB API Keyï¼Ÿ

A: è®¿é—® [TMDB å®˜ç½‘](https://www.themoviedb.org/)ï¼Œæ³¨å†Œè´¦å·ååœ¨è´¦å·è®¾ç½®çš„ API éƒ¨åˆ†ç”³è¯·ã€‚

### Q: æ”¯æŒå“ªäº›è§†é¢‘æ ¼å¼ï¼Ÿ

A: é»˜è®¤æ”¯æŒ .mkv, .mp4, .avi, .mov, .wmv, .flv, .m4v, .ts ç­‰å¸¸è§æ ¼å¼ã€‚

### Q: å¦‚ä½•è‡ªå®šä¹‰é‡å‘½åè§„åˆ™ï¼Ÿ

A: å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„ `RenameRule` å¯¹è±¡ï¼Œä½¿ç”¨ Jinja2 æ¨¡æ¿è¯­æ³•å®šä¹‰å‘½åæ ¼å¼ã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ LICENSE æ–‡ä»¶ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issueã€‚

---

**æ³¨æ„**: å½“å‰ç‰ˆæœ¬ä¸ºå¼€å‘é¢„è§ˆç‰ˆï¼Œéƒ¨åˆ†åŠŸèƒ½å°šæœªå®Œæˆã€‚
